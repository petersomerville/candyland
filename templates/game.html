<!DOCTYPE html>
<html>
<head>
    <title>Candyland Game</title>
    <style>
        .game-board {
            display: flex;
            flex-wrap: wrap;
            max-width: 800px;
            margin: 20px auto;
        }
        
        .space {
            width: 60px;
            height: 60px;
            border: 1px solid #000;
            margin: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .space:nth-child(6n+1) { background-color: red; }
        .space:nth-child(6n+2) { background-color: purple; }
        .space:nth-child(6n+3) { background-color: yellow; }
        .space:nth-child(6n+4) { background-color: blue; }
        .space:nth-child(6n+5) { background-color: orange; }
        .space:nth-child(6n) { background-color: green; }

        .special { background-color: pink; font-weight: bold; }

        .player-token {
            border: 2px solid white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            position: absolute;
        }
        
        .player1 { background-color: blue; top: 5px; left: 5px; }
        .player2 { background-color: red; top: 5px; right: 5px; }
        .player3 { background-color: green; bottom: 5px; left: 5px; }
        .player4 { background-color: yellow; bottom: 5px; right: 5px; }
        
        .controls {
            text-align: center;
            margin: 20px;
        }
        
        .card {
            width: 100px;
            height: 150px;
            border: 1px solid #000;
            margin: 10px auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="controls">
        <button onclick="newGame()">New Game</button>
        <button onclick="drawCard()">Draw Card</button>
        <div id="current-player"></div>
        <div class="card" id="current-card"></div>
    </div>
    
    <div class="game-board" id="board">
        <!-- Board spaces will be generated by JavaScript -->
    </div>

    <script>
        function newGame() {
            fetch('/new_game', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                updateBoard();
                document.getElementById('current-card').innerHTML = '';
            });
        }
        
        function drawCard() {
            fetch('/draw_card', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('current-card').innerHTML = data.card;
                document.getElementById('current-player').innerHTML = 
                    `Current Player: ${data.current_player}`;
                updatePlayerPositions(data.players);
            });
        }
        
        function updatePlayerPositions(players) {
            document.querySelectorAll('.player-token').forEach(token => token.remove());
            Object.entries(players).forEach(([player, position]) => {
                const currentCard = document.getElementById('current-card').innerHTML;
                const specialSpaces = {
                    'Peppermint Forest': 7,
                    'Lollipop Woods': 15,
                    'Gummy Hills': 23
                };

                if (specialSpaces[currentCard]) {
                    position = specialSpaces[currentCard];
                    players[player] = position;
                }
                
                const space = document.querySelector(`[data-index="${position}"]`);
                if (space) {
                    const token = document.createElement('div');
                    token.className = `player-token ${player}`;
                    space.appendChild(token);
                }
            });
        }

        function createBoard() {
            const board = document.getElementById('board');
            const specialSpaces = {7: 'Peppermint Forest', 15: 'Lollipop Woods', 23: 'Gummy Hills'};
            for (let i = 0; i < 60; i++) {
                const space = document.createElement('div');
                space.className = 'space';
                space.setAttribute('data-index', i);
                if (specialSpaces[i]) {
                    space.classList.add('special');
                    space.textContent = specialSpaces[i];
                }
                board.appendChild(space);
            }
        }
        
        createBoard();
        newGame();
    </script>
</body>
</html>
